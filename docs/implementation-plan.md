# cursorrules-mcp é¡¹ç›®å®æ–½è®¡åˆ’

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

cursorrules-mcpæ˜¯ä¸€ä¸ªåŸºäºModel Context Protocolçš„æ™ºèƒ½è§„åˆ™ç®¡ç†ç³»ç»Ÿï¼Œæ—¨åœ¨ä¸ºå¤šæ ·åŒ–çš„ç¼–ç¨‹å’ŒæŠ€æœ¯æ–‡æ¡£ä»»åŠ¡æä¾›ä¸“ä¸šåŒ–ã€è§„èŒƒåŒ–çš„LLMè¾…åŠ©ï¼Œç¡®ä¿è·¨é¢†åŸŸé¡¹ç›®çš„å†…å®¹ä¸é£æ ¼ä¸€è‡´æ€§ã€‚

## ğŸ“Š æŠ€æœ¯æ¶æ„è®¾è®¡

### æ ¸å¿ƒç»„ä»¶æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    cursorrules-mcp ç³»ç»Ÿ                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    å®¢æˆ·ç«¯å±‚          â”‚      æœåŠ¡å±‚          â”‚      æ•°æ®å±‚          â”‚
â”‚                    â”‚                    â”‚                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚   Cursor IDE    â”‚ â”‚ â”‚ cursorrules-mcp â”‚ â”‚ â”‚   MongoDB       â”‚ â”‚
â”‚ â”‚   (MCP Client)  â”‚ â”‚ â”‚    Service      â”‚ â”‚ â”‚  (è§„åˆ™å­˜å‚¨)      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚  (MCP Server)   â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚   Web UI        â”‚ â”‚ â”‚   Rule Engine   â”‚ â”‚ â”‚  Elasticsearch  â”‚ â”‚
â”‚ â”‚  (ç®¡ç†ç•Œé¢)      â”‚ â”‚ â”‚  (è§„åˆ™å¼•æ“)      â”‚ â”‚ â”‚  (æœç´¢ç´¢å¼•)      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                    â”‚                    â”‚                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚    APIè°ƒç”¨       â”‚ â”‚ â”‚ Context Manager â”‚ â”‚ â”‚     Redis       â”‚ â”‚
â”‚ â”‚   (ç¬¬ä¸‰æ–¹é›†æˆ)    â”‚ â”‚ â”‚  (ä¸Šä¸‹æ–‡ç®¡ç†)    â”‚ â”‚ â”‚   (ç¼“å­˜å±‚)       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åˆ†é˜¶æ®µæŠ€æœ¯é€‰å‹

#### ç¬¬ä¸€é˜¶æ®µï¼šMVPå®ç°
| ç»„ä»¶ | æŠ€æœ¯é€‰æ‹© | ç†ç”± |
|------|----------|------|
| **Webæ¡†æ¶** | FastAPI | é«˜æ€§èƒ½ã€ç±»å‹å®‰å…¨ã€è‡ªåŠ¨æ–‡æ¡£ç”Ÿæˆ |
| **æ•°æ®åº“** | MongoDB | çµæ´»Schemaã€JSONåŸç”Ÿæ”¯æŒ |
| **æœç´¢å¼•æ“** | Elasticsearch | å¼ºå¤§çš„å…¨æ–‡æ£€ç´¢å’Œèšåˆåˆ†æ |
| **ç¼“å­˜** | Redis | é«˜æ€§èƒ½é”®å€¼å­˜å‚¨ã€ä¼šè¯ç®¡ç† |
| **æ¶ˆæ¯é˜Ÿåˆ—** | Celery + Redis | å¼‚æ­¥ä»»åŠ¡å¤„ç† |
| **åè®®** | MCP over Stdio/HTTP | æ ‡å‡†åŒ–LLMé€šä¿¡åè®® |

#### ç¬¬äºŒé˜¶æ®µï¼šæ¶æ„å‡çº§
| ç»„ä»¶ | æŠ€æœ¯é€‰æ‹© | ç†ç”± |
|------|----------|------|
| **APIåè®®** | gRPC + REST | é«˜æ€§èƒ½å†…éƒ¨é€šä¿¡ + å¹¿æ³›å…¼å®¹æ€§ |
| **å…³ç³»æ•°æ®åº“** | PostgreSQL | ACIDç‰¹æ€§ã€å¤æ‚æŸ¥è¯¢æ”¯æŒ |
| **ç‰ˆæœ¬æ§åˆ¶** | Git + GitLab API | è§„åˆ™ç‰ˆæœ¬ç®¡ç†å’Œåä½œ |
| **ç›‘æ§** | Prometheus + Grafana | ç³»ç»Ÿæ€§èƒ½ç›‘æ§ |
| **å®¹å™¨åŒ–** | Docker + Kubernetes | å¾®æœåŠ¡éƒ¨ç½²å’Œæ‰©å±• |

#### ç¬¬ä¸‰é˜¶æ®µï¼šæ™ºèƒ½åŒ–å‡çº§
| ç»„ä»¶ | æŠ€æœ¯é€‰æ‹© | ç†ç”± |
|------|----------|------|
| **çŸ¥è¯†å›¾è°±** | Neo4j | å›¾æ•°æ®åº“ã€å¤æ‚å…³ç³»æŸ¥è¯¢ |
| **å‘é‡æ•°æ®åº“** | Qdrant/Weaviate | è¯­ä¹‰æœç´¢ã€ç›¸ä¼¼åº¦è®¡ç®— |
| **RAGæ¡†æ¶** | LangChain + LlamaIndex | æ£€ç´¢å¢å¼ºç”Ÿæˆ |
| **MLæ¨¡å‹** | Sentence-BERT | è¯­ä¹‰åµŒå…¥å’Œç›¸ä¼¼åº¦ |

## ğŸ“… è¯¦ç»†å®æ–½æ—¶é—´è¡¨

### ç¬¬ä¸€é˜¶æ®µï¼šMVPå¼€å‘ï¼ˆ10å‘¨ï¼‰

#### Week 1-2: é¡¹ç›®åˆå§‹åŒ–å’ŒåŸºç¡€æ¶æ„
- [ ] é¡¹ç›®è„šæ‰‹æ¶æ­å»º
- [ ] MongoDBé›†ç¾¤éƒ¨ç½²
- [ ] Elasticsearché›†ç¾¤é…ç½®
- [ ] Redisç¼“å­˜å±‚è®¾ç½®
- [ ] åŸºç¡€APIæ¡†æ¶ï¼ˆFastAPIï¼‰

#### Week 3-4: è§„åˆ™ç®¡ç†ç³»ç»Ÿ
- [ ] è§„åˆ™Schemaè®¾è®¡å’ŒéªŒè¯
- [ ] CRUD APIå¼€å‘
- [ ] æ ‡ç­¾ç³»ç»Ÿå®ç°
- [ ] åŸºç¡€æœç´¢åŠŸèƒ½

#### Week 5-6: MCPæœåŠ¡å®ç°
- [ ] MCPåè®®é€‚é…
- [ ] Cursor IDEé›†æˆ
- [ ] è§„åˆ™æ£€ç´¢å¼•æ“
- [ ] åŸºç¡€LLMæ¥å£

#### Week 7-8: ä¸€è‡´æ€§æ£€æŸ¥å™¨
- [ ] ä»£ç é£æ ¼æ£€æŸ¥é›†æˆï¼ˆpylint, eslintç­‰ï¼‰
- [ ] æ–‡æ¡£æ ¼å¼éªŒè¯
- [ ] è‡ªå®šä¹‰è§„åˆ™éªŒè¯å™¨
- [ ] ç»“æœåå¤„ç†pipeline

#### Week 9-10: æµ‹è¯•å’Œä¼˜åŒ–
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–
- [ ] é›†æˆæµ‹è¯•
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] éƒ¨ç½²å’Œå‘å¸ƒ

### ç¬¬äºŒé˜¶æ®µï¼šæ¶æ„å‡çº§ï¼ˆ8å‘¨ï¼‰

#### Week 11-12: å¾®æœåŠ¡æ‹†åˆ†
- [ ] æœåŠ¡æ‹†åˆ†è®¾è®¡
- [ ] gRPCæ¥å£å®šä¹‰
- [ ] API Gatewayå®ç°
- [ ] æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡

#### Week 13-14: ä¸Šä¸‹æ–‡ç®¡ç†ç³»ç»Ÿ
- [ ] é¡¹ç›®çŠ¶æ€ç®¡ç†
- [ ] ä¼šè¯æŒä¹…åŒ–
- [ ] å†å²ç‰ˆæœ¬è¿½è¸ª
- [ ] å¢é‡æ›´æ–°æœºåˆ¶

#### Week 15-16: å¤šLLMæ”¯æŒ
- [ ] LLMæŠ½è±¡å±‚è®¾è®¡
- [ ] æ¨¡å‹è·¯ç”±ç­–ç•¥
- [ ] æ€§èƒ½ç›‘æ§å’Œåˆ‡æ¢
- [ ] æˆæœ¬ä¼˜åŒ–ç®—æ³•

#### Week 17-18: é«˜çº§éªŒè¯
- [ ] è¯­ä¹‰ä¸€è‡´æ€§æ£€æŸ¥
- [ ] è·¨æ–‡ä»¶å…³è”åˆ†æ
- [ ] è´¨é‡è¯„åˆ†ç³»ç»Ÿ
- [ ] è‡ªåŠ¨ä¿®æ­£å»ºè®®

### ç¬¬ä¸‰é˜¶æ®µï¼šæ™ºèƒ½åŒ–å‡çº§ï¼ˆ12å‘¨ï¼‰

#### Week 19-22: çŸ¥è¯†å›¾è°±æ„å»º
- [ ] æœ¬ä½“è®¾è®¡å’Œå»ºæ¨¡
- [ ] æ•°æ®å¯¼å…¥å’Œæ¸…æ´—
- [ ] å›¾æŸ¥è¯¢ä¼˜åŒ–
- [ ] å…³ç³»æ¨ç†å¼•æ“

#### Week 23-26: RAGç³»ç»Ÿå®ç°
- [ ] æ–‡æ¡£å‘é‡åŒ–
- [ ] è¯­ä¹‰æ£€ç´¢å¼•æ“
- [ ] å¤šæ¨¡æ€ç´¢å¼•
- [ ] æ£€ç´¢è´¨é‡è¯„ä¼°

#### Week 27-30: é«˜çº§åŠŸèƒ½
- [ ] å¤šè·³æ¨ç†å®ç°
- [ ] ä¸Šä¸‹æ–‡è‡ªé€‚åº”ä¼˜åŒ–
- [ ] ä¸ªæ€§åŒ–æ¨è
- [ ] æ™ºèƒ½è§„åˆ™ç”Ÿæˆ

## ğŸ—ï¸ é¡¹ç›®ç»“æ„è®¾è®¡

åŸºäºå…¨æ ˆååŒå¼€å‘è§„èŒƒï¼Œæ¨èä»¥ä¸‹ç›®å½•ç»“æ„ï¼š

```
cursorrules-mcp/
â”œâ”€â”€ src/                          # æ ¸å¿ƒæºç 
â”‚   â”œâ”€â”€ api/                      # APIæ¥å£å±‚
â”‚   â”œâ”€â”€ core/                     # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ models/                   # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ services/                 # ä¸šåŠ¡æœåŠ¡
â”œâ”€â”€ include/                      # å…¬å…±å¤´æ–‡ä»¶
â”œâ”€â”€ tests/                        # æµ‹è¯•ä»£ç 
â”œâ”€â”€ tools/                        # å·¥å…·è„šæœ¬
â”œâ”€â”€ mcp/                         # MCPæœåŠ¡æ¨¡å—
â”œâ”€â”€ configs/                     # é…ç½®æ–‡ä»¶
â”œâ”€â”€ docs/                        # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ examples/                    # ç¤ºä¾‹å’Œæ ·ä¾‹
â”œâ”€â”€ scripts/                     # æ„å»ºéƒ¨ç½²è„šæœ¬
â””â”€â”€ rules/                       # è§„åˆ™åº“
    â”œâ”€â”€ languages/               # ç¼–ç¨‹è¯­è¨€è§„åˆ™
    â”œâ”€â”€ domains/                 # é¢†åŸŸä¸“ä¸šè§„åˆ™
    â”œâ”€â”€ projects/                # é¡¹ç›®ç‰¹å®šè§„åˆ™
    â””â”€â”€ templates/               # æ¨¡æ¿åº“
```

## ğŸ“ è§„åˆ™Schemaè®¾è®¡

### è§„åˆ™å®šä¹‰ç»“æ„ï¼ˆJSON Schemaï¼‰

```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "rule_id": {
      "type": "string",
      "pattern": "^CR-[A-Z]{2,4}-[A-Z0-9]+-[0-9]{3}$",
      "description": "è§„åˆ™å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œæ ¼å¼ï¼šCR-[è¯­è¨€/é¢†åŸŸ]-[åˆ†ç±»]-[ç¼–å·]"
    },
    "name": {
      "type": "string",
      "minLength": 5,
      "maxLength": 100,
      "description": "è§„åˆ™çš„ç®€çŸ­åç§°"
    },
    "description": {
      "type": "string",
      "minLength": 20,
      "maxLength": 500,
      "description": "è§„åˆ™çš„è¯¦ç»†æè¿°"
    },
    "category": {
      "type": "string",
      "enum": ["style", "content", "format", "semantic", "performance", "security"],
      "description": "è§„åˆ™ç±»åˆ«"
    },
    "priority": {
      "type": "integer",
      "minimum": 1,
      "maximum": 10,
      "description": "è§„åˆ™ä¼˜å…ˆçº§ï¼ˆ1-10ï¼Œ10ä¸ºæœ€é«˜ï¼‰"
    },
    "tags": {
      "type": "array",
      "items": {
        "type": "string",
        "pattern": "^[a-z_]+$"
      },
      "description": "æ ‡ç­¾æ•°ç»„ï¼Œç”¨äºæœç´¢å’Œåˆ†ç±»"
    },
    "applicable_to": {
      "type": "object",
      "properties": {
        "languages": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["python", "cpp", "fortran", "shell", "markdown", "latex"]
          }
        },
        "domains": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["meteorology", "ionosphere", "surveying", "oceanography", "geophysics"]
          }
        },
        "content_types": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["code", "documentation", "data_interface", "algorithm"]
          }
        }
      }
    },
    "rule_content": {
      "type": "object",
      "properties": {
        "pattern": {
          "type": "string",
          "description": "æ­£åˆ™è¡¨è¾¾å¼æˆ–æ£€æŸ¥æ¨¡å¼"
        },
        "guideline": {
          "type": "string",
          "description": "è‡ªç„¶è¯­è¨€æè¿°çš„æŒ‡å¯¼åŸåˆ™"
        },
        "examples": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "good": {"type": "string"},
              "bad": {"type": "string"},
              "explanation": {"type": "string"}
            }
          }
        }
      }
    },
    "validation": {
      "type": "object",
      "properties": {
        "tools": {
          "type": "array",
          "items": {"type": "string"},
          "description": "å¯ç”¨çš„éªŒè¯å·¥å…·åˆ—è¡¨"
        },
        "severity": {
          "type": "string",
          "enum": ["error", "warning", "info"],
          "description": "è¿åè§„åˆ™çš„ä¸¥é‡ç¨‹åº¦"
        }
      }
    },
    "metadata": {
      "type": "object",
      "properties": {
        "version": {"type": "string"},
        "author": {"type": "string"},
        "created_at": {"type": "string", "format": "date-time"},
        "updated_at": {"type": "string", "format": "date-time"},
        "dependencies": {
          "type": "array",
          "items": {"type": "string"}
        }
      }
    }
  },
  "required": ["rule_id", "name", "description", "category", "tags", "applicable_to", "rule_content"]
}
```

## ğŸ”§ å…³é”®æŠ€æœ¯å®ç°

### 1. æ ‡ç­¾ç³»ç»Ÿè®¾è®¡

é‡‡ç”¨å±‚çº§åŒ–æ ‡ç­¾ç»“æ„ï¼Œæ”¯æŒå¤šç»´åº¦äº¤å‰æœç´¢ï¼š

```python
class TagSystem:
    """å±‚çº§åŒ–æ ‡ç­¾ç³»ç»Ÿ"""
    
    def __init__(self):
        self.hierarchy = {
            'language': ['python', 'cpp', 'fortran', 'shell'],
            'domain': {
                'meteorology': ['numerical_modeling', 'data_analysis', 'visualization'],
                'ionosphere': ['tec_modeling', 'radio_occultation', 'scintillation'],
                'surveying': ['gnss', 'coordinate_transformation', 'precision_measurement']
            },
            'task': ['coding', 'documentation', 'analysis', 'visualization'],
            'quality': ['style', 'performance', 'security', 'maintainability']
        }
    
    def expand_tags(self, tags: List[str]) -> List[str]:
        """æ‰©å±•æ ‡ç­¾ï¼ŒåŒ…å«å±‚çº§å…³ç³»"""
        expanded = set(tags)
        for tag in tags:
            if ':' in tag:  # å±‚çº§æ ‡ç­¾å¦‚ "meteorology:numerical_modeling"
                parts = tag.split(':')
                expanded.update([':'.join(parts[:i+1]) for i in range(len(parts))])
        return list(expanded)
    
    def find_related_rules(self, tags: List[str], threshold: float = 0.7) -> List[str]:
        """åŸºäºæ ‡ç­¾ç›¸ä¼¼åº¦æŸ¥æ‰¾ç›¸å…³è§„åˆ™"""
        # å®ç°åŸºäºæ ‡ç­¾çš„ç›¸ä¼¼åº¦ç®—æ³•
        pass
```

### 2. ä¸€è‡´æ€§æ£€æŸ¥å¼•æ“

å¤šå±‚æ¬¡éªŒè¯æœºåˆ¶ï¼š

```python
class ConsistencyChecker:
    """ä¸€è‡´æ€§æ£€æŸ¥å¼•æ“"""
    
    def __init__(self):
        self.validators = {
            'code': [PEP8Validator(), CppStyleValidator(), FortranStyleValidator()],
            'documentation': [MarkdownValidator(), DocstringValidator()],
            'semantic': [SemanticConsistencyValidator()]
        }
    
    async def validate(self, content: str, content_type: str, rules: List[Rule]) -> ValidationResult:
        """æ‰§è¡Œä¸€è‡´æ€§æ£€æŸ¥"""
        results = []
        
        # é™æ€æ£€æŸ¥
        for validator in self.validators.get(content_type, []):
            result = await validator.validate(content, rules)
            results.append(result)
        
        # è¯­ä¹‰æ£€æŸ¥
        if content_type in ['code', 'documentation']:
            semantic_result = await self._semantic_validation(content, rules)
            results.append(semantic_result)
        
        return self._aggregate_results(results)
    
    async def _semantic_validation(self, content: str, rules: List[Rule]) -> ValidationResult:
        """åŸºäºLLMçš„è¯­ä¹‰ä¸€è‡´æ€§æ£€æŸ¥"""
        # æ„é€ éªŒè¯æç¤º
        prompt = self._build_validation_prompt(content, rules)
        
        # è°ƒç”¨LLMè¿›è¡ŒéªŒè¯
        response = await self.llm_client.validate(prompt)
        
        return self._parse_validation_response(response)
```

### 3. MCPæœåŠ¡å®ç°

åŸºäºFastAPIçš„MCPæœåŠ¡å™¨ï¼š

```python
from mcp.server import Server
from mcp.types import Tool, TextContent

class CursorRulesMCPServer:
    """cursorrules MCPæœåŠ¡å™¨"""
    
    def __init__(self):
        self.server = Server("cursorrules-mcp")
        self.rule_engine = RuleEngine()
        self.setup_tools()
    
    def setup_tools(self):
        """æ³¨å†ŒMCPå·¥å…·"""
        
        @self.server.tool("search_rules")
        async def search_rules(query: str, tags: List[str] = None) -> List[TextContent]:
            """æœç´¢é€‚ç”¨çš„è§„åˆ™"""
            rules = await self.rule_engine.search(query, tags)
            return [TextContent(text=rule.format_for_llm()) for rule in rules]
        
        @self.server.tool("validate_content")
        async def validate_content(content: str, content_type: str) -> TextContent:
            """éªŒè¯å†…å®¹ä¸€è‡´æ€§"""
            result = await self.rule_engine.validate(content, content_type)
            return TextContent(text=result.format_report())
        
        @self.server.tool("get_templates")
        async def get_templates(template_type: str, domain: str = None) -> List[TextContent]:
            """è·å–æ¨¡æ¿"""
            templates = await self.rule_engine.get_templates(template_type, domain)
            return [TextContent(text=template.content) for template in templates]

    async def run(self):
        """å¯åŠ¨MCPæœåŠ¡å™¨"""
        await self.server.run()
```

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡å’Œç›‘æ§

### å…³é”®æ€§èƒ½æŒ‡æ ‡ï¼ˆKPIï¼‰

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | ç›‘æ§æ–¹å¼ |
|------|--------|----------|
| **å“åº”æ—¶é—´** | <500ms (p95) | Prometheus + Grafana |
| **å¯ç”¨æ€§** | 99.9% | å¥åº·æ£€æŸ¥ + å‘Šè­¦ |
| **è§„åˆ™è¦†ç›–ç‡** | >90% | ä»£ç åˆ†æ + ç»Ÿè®¡ |
| **ä¸€è‡´æ€§å‡†ç¡®ç‡** | >95% | äººå·¥è¯„ä¼° + A/Bæµ‹è¯• |
| **ç”¨æˆ·æ»¡æ„åº¦** | >4.5/5 | é—®å·è°ƒæŸ¥ + ä½¿ç”¨åé¦ˆ |

### ç›‘æ§ä½“ç³»

```python
from prometheus_client import Counter, Histogram, Gauge
import structlog

# ç›‘æ§æŒ‡æ ‡å®šä¹‰
rule_search_duration = Histogram('rule_search_duration_seconds', 'Rule search duration')
rule_cache_hits = Counter('rule_cache_hits_total', 'Rule cache hits')
validation_errors = Counter('validation_errors_total', 'Validation errors', ['error_type'])
active_sessions = Gauge('active_sessions', 'Number of active sessions')

logger = structlog.get_logger()

class MonitoringMixin:
    """ç›‘æ§æ··å…¥ç±»"""
    
    def monitor_performance(self, func_name: str):
        """æ€§èƒ½ç›‘æ§è£…é¥°å™¨"""
        def decorator(func):
            async def wrapper(*args, **kwargs):
                start_time = time.time()
                try:
                    result = await func(*args, **kwargs)
                    logger.info("function_executed", 
                              function=func_name, 
                              duration=time.time() - start_time,
                              status="success")
                    return result
                except Exception as e:
                    logger.error("function_failed",
                               function=func_name,
                               duration=time.time() - start_time,
                               error=str(e))
                    raise
            return wrapper
        return decorator
```

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### æµ‹è¯•å±‚æ¬¡

1. **å•å…ƒæµ‹è¯•**ï¼šè¦†ç›–æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
2. **é›†æˆæµ‹è¯•**ï¼šéªŒè¯ç»„ä»¶é—´äº¤äº’
3. **ç«¯åˆ°ç«¯æµ‹è¯•**ï¼šæ¨¡æ‹ŸçœŸå®ä½¿ç”¨åœºæ™¯
4. **æ€§èƒ½æµ‹è¯•**ï¼šå‹åŠ›æµ‹è¯•å’ŒåŸºå‡†æµ‹è¯•
5. **ç”¨æˆ·éªŒæ”¶æµ‹è¯•**ï¼šå®é™…ç”¨æˆ·åœºæ™¯éªŒè¯

### æµ‹è¯•ç”¨ä¾‹ç¤ºä¾‹

```python
import pytest
from unittest.mock import AsyncMock

class TestRuleEngine:
    """è§„åˆ™å¼•æ“æµ‹è¯•"""
    
    @pytest.fixture
    async def rule_engine(self):
        engine = RuleEngine()
        await engine.initialize()
        return engine
    
    async def test_search_rules_by_tags(self, rule_engine):
        """æµ‹è¯•åŸºäºæ ‡ç­¾çš„è§„åˆ™æœç´¢"""
        # å‡†å¤‡æµ‹è¯•æ•°æ®
        tags = ["python", "meteorology", "data_analysis"]
        
        # æ‰§è¡Œæœç´¢
        rules = await rule_engine.search_by_tags(tags)
        
        # éªŒè¯ç»“æœ
        assert len(rules) > 0
        assert all(any(tag in rule.tags for tag in tags) for rule in rules)
    
    async def test_validate_python_code(self, rule_engine):
        """æµ‹è¯•Pythonä»£ç éªŒè¯"""
        # æµ‹è¯•ç¬¦åˆè§„èŒƒçš„ä»£ç 
        good_code = """
def calculate_temperature_mean(data):
    \"\"\"è®¡ç®—æ¸©åº¦å¹³å‡å€¼\"\"\"
    return sum(data) / len(data)
"""
        result = await rule_engine.validate(good_code, "python")
        assert result.is_valid
        
        # æµ‹è¯•ä¸ç¬¦åˆè§„èŒƒçš„ä»£ç 
        bad_code = "def calc(d):return sum(d)/len(d)"  # è¿åPEP8
        result = await rule_engine.validate(bad_code, "python")
        assert not result.is_valid
        assert "PEP8" in str(result.violations)
```

## ğŸ“š æ–‡æ¡£è§„èŒƒ

éµå¾ªæ–‡æ¡£ç¼–å†™ä»»åŠ¡è§„åˆ™ï¼Œç¡®ä¿ï¼š

1. **ä¸­ç«‹å®¢è§‚**ï¼šåŸºäºæŠ€æœ¯äº‹å®å’Œæœ€ä½³å®è·µ
2. **ä¸“ä¸šç²¾å‡†**ï¼šä½¿ç”¨æ ‡å‡†æœ¯è¯­å’Œæƒå¨å‚è€ƒ
3. **ç»“æ„æ¸…æ™°**ï¼šé‡‡ç”¨ç»Ÿä¸€çš„æ–‡æ¡£æ¨¡æ¿

### æ–‡æ¡£ç»“æ„æ¨¡æ¿

```markdown
# [åŠŸèƒ½æ¨¡å—åç§°]

## æ¦‚è¿°
ç®€è¿°æ¨¡å—åŠŸèƒ½å’Œç”¨é€”

## æŠ€æœ¯è§„èŒƒ
### APIæ¥å£
### æ•°æ®æ¨¡å‹
### é…ç½®å‚æ•°

## ä½¿ç”¨æŒ‡å—
### å¿«é€Ÿå¼€å§‹
### å¸¸è§ç”¨ä¾‹
### æœ€ä½³å®è·µ

## å¼€å‘æŒ‡å—
### æœ¬åœ°å¼€å‘ç¯å¢ƒ
### æµ‹è¯•æŒ‡å—
### è°ƒè¯•æŠ€å·§

## å‚è€ƒèµ„æ–™
### ç›¸å…³æ ‡å‡†
### å¤–éƒ¨æ–‡æ¡£
### æ›´æ–°æ—¥å¿—
```

## ğŸš€ éƒ¨ç½²æ–¹æ¡ˆ

### å®¹å™¨åŒ–éƒ¨ç½²

```yaml
# docker-compose.yml
version: '3.8'
services:
  cursorrules-mcp:
    build: .
    ports:
      - "8000:8000"
    environment:
      - MONGODB_URL=mongodb://mongo:27017
      - ELASTICSEARCH_URL=http://elasticsearch:9200
      - REDIS_URL=redis://redis:6379
    depends_on:
      - mongo
      - elasticsearch
      - redis

  mongo:
    image: mongo:5.0
    volumes:
      - mongo_data:/data/db

  elasticsearch:
    image: elasticsearch:8.5.0
    environment:
      - discovery.type=single-node
      - xpack.security.enabled=false
    volumes:
      - es_data:/usr/share/elasticsearch/data

  redis:
    image: redis:7-alpine
    volumes:
      - redis_data:/data

volumes:
  mongo_data:
  es_data:
  redis_data:
```

### Kuberneteséƒ¨ç½²

```yaml
# k8s-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: cursorrules-mcp
spec:
  replicas: 3
  selector:
    matchLabels:
      app: cursorrules-mcp
  template:
    metadata:
      labels:
        app: cursorrules-mcp
    spec:
      containers:
      - name: cursorrules-mcp
        image: cursorrules-mcp:latest
        ports:
        - containerPort: 8000
        env:
        - name: MONGODB_URL
          valueFrom:
            secretKeyRef:
              name: db-secrets
              key: mongodb-url
        resources:
          requests:
            memory: "512Mi"
            cpu: "250m"
          limits:
            memory: "1Gi"
            cpu: "500m"
```

## ğŸ’° æˆæœ¬ä¼°ç®—

### å¼€å‘æˆæœ¬ï¼ˆäººæœˆï¼‰

| é˜¶æ®µ | åç«¯å¼€å‘ | å‰ç«¯å¼€å‘ | DevOps | æµ‹è¯• | æ€»è®¡ |
|------|----------|----------|--------|------|------|
| ç¬¬ä¸€é˜¶æ®µ | 4äººæœˆ | 2äººæœˆ | 1äººæœˆ | 2äººæœˆ | 9äººæœˆ |
| ç¬¬äºŒé˜¶æ®µ | 3äººæœˆ | 1äººæœˆ | 2äººæœˆ | 2äººæœˆ | 8äººæœˆ |
| ç¬¬ä¸‰é˜¶æ®µ | 6äººæœˆ | 2äººæœˆ | 2äººæœˆ | 3äººæœˆ | 13äººæœˆ |
| **æ€»è®¡** | **13äººæœˆ** | **5äººæœˆ** | **5äººæœˆ** | **7äººæœˆ** | **30äººæœˆ** |

### åŸºç¡€è®¾æ–½æˆæœ¬ï¼ˆæœˆï¼‰

| èµ„æº | ç¬¬ä¸€é˜¶æ®µ | ç¬¬äºŒé˜¶æ®µ | ç¬¬ä¸‰é˜¶æ®µ |
|------|----------|----------|----------|
| è®¡ç®—èµ„æº | $500 | $1200 | $2500 |
| å­˜å‚¨èµ„æº | $200 | $400 | $800 |
| ç½‘ç»œèµ„æº | $100 | $200 | $300 |
| ç¬¬ä¸‰æ–¹æœåŠ¡ | $300 | $500 | $800 |
| **æ€»è®¡** | **$1100** | **$2300** | **$4400** |

## ğŸ¯ é¡¹ç›®é‡Œç¨‹ç¢‘

### å…³é”®å†³ç­–ç‚¹

1. **Week 4**: MVPæ ¸å¿ƒåŠŸèƒ½éªŒè¯
2. **Week 8**: ç¬¬ä¸€é˜¶æ®µç”¨æˆ·æµ‹è¯•
3. **Week 12**: æ¶æ„å‡çº§è¯„ä¼°
4. **Week 20**: çŸ¥è¯†å›¾è°±æ•ˆæœéªŒè¯
5. **Week 28**: ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–å®Œæˆ

### é£é™©æ§åˆ¶

| é£é™©ç±»å‹ | æ¦‚ç‡ | å½±å“ | ç¼“è§£æªæ–½ |
|----------|------|------|----------|
| æŠ€æœ¯éš¾åº¦è¶…é¢„æœŸ | ä¸­ | é«˜ | åˆ†é˜¶æ®µå®æ–½ã€æŠ€æœ¯é¢„ç ” |
| æ€§èƒ½ä¸è¾¾æ ‡ | ä½ | ä¸­ | æ—©æœŸæ€§èƒ½æµ‹è¯•ã€æ¶æ„ä¼˜åŒ– |
| ç”¨æˆ·æ¥å—åº¦ä½ | ä½ | é«˜ | ç”¨æˆ·å‚ä¸è®¾è®¡ã€å¿«é€Ÿè¿­ä»£ |
| èµ„æºæŠ•å…¥ä¸è¶³ | ä¸­ | ä¸­ | åˆ†é˜¶æ®µæŠ•èµ„ã€ä»·å€¼éªŒè¯ |

## ğŸ“Š æˆåŠŸæŒ‡æ ‡

### çŸ­æœŸç›®æ ‡ï¼ˆ3-6ä¸ªæœˆï¼‰
- [ ] ç³»ç»Ÿç¨³å®šè¿è¡Œï¼Œæ”¯æ’‘æ—¥å¸¸å¼€å‘å·¥ä½œ
- [ ] è§„åˆ™åº“è¦†ç›–ä¸»è¦ç¼–ç¨‹è¯­è¨€å’Œé¢†åŸŸ
- [ ] ä»£ç è´¨é‡æå‡20%ä»¥ä¸Š
- [ ] æ–‡æ¡£ä¸€è‡´æ€§æ”¹å–„æ˜¾è‘—

### ä¸­æœŸç›®æ ‡ï¼ˆ6-12ä¸ªæœˆï¼‰
- [ ] å»ºç«‹å®Œæ•´çš„çŸ¥è¯†ç®¡ç†ä½“ç³»
- [ ] å®ç°æ™ºèƒ½åŒ–è§„åˆ™æ¨è
- [ ] å¼€å‘æ•ˆç‡æå‡30%ä»¥ä¸Š
- [ ] å½¢æˆæœ€ä½³å®è·µæ²‰æ·€

### é•¿æœŸæ„¿æ™¯ï¼ˆ1-2å¹´ï¼‰
- [ ] æˆä¸ºè¡Œä¸šé¢†å…ˆçš„è§„åˆ™ç®¡ç†å¹³å°
- [ ] æ”¯æŒå¤šå›¢é˜Ÿåä½œå’ŒçŸ¥è¯†å…±äº«
- [ ] å®ç°çœŸæ­£çš„æ™ºèƒ½åŒ–å¼€å‘è¾…åŠ©
- [ ] å»ºç«‹å¼€æºç¤¾åŒºç”Ÿæ€

---

**é¡¹ç›®è”ç³»äºº**ï¼š[é¡¹ç›®è´Ÿè´£äºº]  
**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0  
**æœ€åæ›´æ–°**ï¼š2024å¹´12æœˆ  